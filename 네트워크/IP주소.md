## ARP
컴퓨터와 컴퓨터 간의 통신은 흔히들 IP주소 기반으로 통신한다고 알고 있지만, 정확히 이야기 하자면 IP주소에서 ARP를 통해 MAC주소를 찾아 MAC주소를 기반으로 통신합니다.

ARP(Address Resolution Protocol)이란 IP주소로부터 MAC주소를 구하는 IP와 MAC주소의 다리 역할을 하는 프로토콜입니다.

## 홉바이 홉 통신
건너 뛰는 모습을 표현 이는 통신망에서 패킷이 여러개의 라우터를 건너가는 모습을 비유적으로 표현 각각의 라우터에 있는 라우팅테이블의 IP를 기반으로 패킷을 전달하고 다시 전달해감. 통신장치에 있는 라우팅 테이들의 IP를 통해 시작주소부터 다음 IP로 계속 이동하는 라우팅 과정을 거쳐 패킷이 최종 목적지 까지 도착하는 통신을 의미함


## 클래스별 할당방식
이는 [[서브네팅, FLSM, VLSM]] 에 서술되어 있다.

## DHCP 프로토콜

-   DHCP(Dynamic Host Configuration Protocol)은 호스트 IP 구성 관리를 단순화하기 위하여, IP 주소 및 관련된 기타 구성 정보를 네트워크를 통해 동적으로 할당하는 프로토콜이다.
-   DHCP를 사용하면 사용자가 직접 입력해야 하는 IP 주소, 서브넷 마스크, 게이트웨이, DNS 정보 등을 자동으로 할당받아 사용할 수 있다.
-   DHCP는 BOOTP 프로토콜을 확장한 프로토콜이기 때문에 서버의 서비스 포트는 67(bootps), 클라이언트 서비스 포트는 68(bootpc)을 사용한다.
-   DHCP 동작 과정
    1.  DHCP Discover
        -   DHCP 클라이언트가 DHCP 서버를 찾기 위해 DHCP Discover 메시지를 브로드캐스트로 송신한다.
        -   아직 클라이언트는 IP를 할당받지 않은 상태이기 때문에 패킷의 Source IP 주소는 0.0.0.0으로 설정된다. Destination IP는 브로드캐스트 주소로 설정된다.
        -   DHCP 메시지에는 클라이언트의 MAC 주소가 포함된다.
    2.  DHCP Offer
        -   DHCP Discover 메시지를 수신한 DHCP 서버가 클라이언트에게 서버에 대한 정보를 포함한 DHCP 메시지를 송신한다.
        -   DHCP 메시지에는 클라이언트에 할당할 IP, 클라이언트 MAC, 서브넷, 게이트웨이, DNS 정보, Lease Time, Server 식별자 등의 정보가 포함된다.
        -   아직 클라이언트의 IP 주소가 할당되지 않았으므로 Destination IP 주소는 브로드캐스트이다.
    3.  DHCP Request
        -   DHCP 클라이언트가 DHCP 서버에게 주소를 할당받기 위하여 DHCP Request 메시지를 브로드캐스트로 송신한다.
        -   마찬가지로 아직 클라이언트는 IP를 할당받지 않은 상태이기 때문에 패킷의 Source IP 주소는 0.0.0.0으로 설정되며 Destination IP는 브로드캐스트 주소로 설정된다.
        -   DHCP 메시지에는 DHCP 서버로부터 제안받은 IP 주소, 클라이언트 MAC, DHCP 서버 식별자 등이 포함된다.
    4.  DHCP Acknowledgement
        -   DHCP Request 메시지를 수신한 DHCP 서버가 해당 IP와 클라이언트의 매핑 정보를 기록하고 DHCP Request 메시지를 정상적으로 처리했다는 응답으로 DHCP ACK 메시지를 송신한다.
        -   클라이언트가 해당 메시지를 수신하면 클라이언트에게 IP 주소를 포함한 네트워크 정보가 정상적으로 할당된다.

## NAT

-   NAT(Network Address Translation)은 IP 패킷의 TCP/UDP 포트 숫자와 소스 목적지의 IP 주소 등을 재기록하면서 라우터를 통해 네트워크 트래픽을 주고 받는 기술이다.
    -   쉽게 설명하면 이름 그대로 네트워크 주소를 변환하는 기술이다. 기본적으로 하나의 네트워크 주소에 다른 하나의 네트워크 주소로 변환하는 1:1 변환이 기본이지만, IP 주소 고갈 문제를 해결하기 위해 여러 개의 IP를 하나의 IP로 변환하기도 한다. 다대일 변환을 NAPT라고 지칭하는데, PAT라는 용어를 사용하기도 한다.
-   NAT는 네트워크 주소를 변환할 때 출발지 주소를 변경하면 SNAT, 목적지 주소를 변환하면 DNAT로 구분한다.
-   PAT 방식으로 동작하는 NAT 장비를 거쳐 외부와 통신하는 과정을 간략화 하면 다음과 같다.
    1.  사용자가 외부로 나가기 위해 패킷에 source addr 1.1.1.1@30000 destination addr 2.2.2.2@80 정보를 채워 전송한다. (source port인 30000은 랜덤 할당)
    2.  NAT 장비는 패킷을 받아 외부 네트워크와 통신이 가능하도록 공인 IP인 10.10.10.10으로 변환한다. 동시에 여러 사용자의 IP가 동일한 공인 IP로 변경되기 때문에 사용자 구분을 위하여 포트 또한 변환한다. 여기서는 33333으로 변환했다고 가정한다.
    3.  NAT 장비에서 source addr 10.10.10.10@33333 destination addr 2.2.2.2@80 패킷에 대하여 체크섬을 다시 계산하고 외부 목적지로 전송한다.
    4.  패킷을 수신한 외부 서버는 source addr 2.2.2.2@80 destination addr 10.10.10.10@33333으로 응답을 보낸다.
    5.  NAT 장비는 NAT 테이블에 기록한 정보를 통해 원래 destination addr를 원래 주소인 1.1.1.1@30000으로 변환한다.
    6.  NAT 장비에서 source addr 2.2.2.2@80 destination addr 1.1.1.1@30000 패킷에 대하여 체크섬을 다시 계산하고 사용자에게 전달한다.