## BGP 프로토콜

-   현대 TCP/IP에서 사용하는 외부 라우팅 프로토콜은 BGP이다. BGP는 EGP를 대체하기 위해 개발되고 개정되어 현재는 BGP-4 버전을 사용한다. BGP 프로토콜은 AS(Autonomous System, 자치 시스템)간에 네트워크 접근 가능 정보를 교환하고 그 정보를 통해 네트워크 경로를 결정한다.
-   각 AS는 BGP 소프트웨어를 실행하는 하나 이상의 라우터가 있어야 하며, BGP 라우터는 서로 연결되어 있어야 한다.
-   BGP 라우터는 네트워크에 관한 정보와 경로를 라우팅 정보 기반(RIB)에 저장하고 BGP 라우터끼리 라우팅 정보를 교환하여 인터네트워크에 전파한다.

## DNS 프로토콜

(비교적 자세하게 설명하고 있는데, 하이라이트 된 부분만 인지해도 문제 없습니다.)

-   DNS(Domain Name Service)는 **호스트의 도메인 이름을 호스트의 네트워크 주소로 바꾸거나 그 반대의 변환을 수행**한다.
-   DNS에서 도메인이란 어떤 공통적인 특징에 근거하여 수집된 단일 객체 또는 객체 집합이다. 일반적으로 DNS에서 의미하는 공통적인 특징이란 동일한 기관에 의해 관리되는 것을 의미한다.
-   **DNS의 네임 계층 구조**와 DNS 계층 기관 구조는 매우 밀접하게 연관되어 있으며, 정확히 일치하지는 않지만 양측 다 **계층적 트리 구조**로 구성되어 있다.
    -   도메인 트리 구조는 루트, 최상위 도메인(TLDs), 2단계 도메인, 하위 도메인(subdomain)으로 구성된다.
-   DNS 공개 네임 정보는 권한 계층에 필적하는 계층으로 구조화된 DNS 네임 서버상의 분산 데이터베이스에 저장된다. 각 구역은 자신의 정보를 관장하는 하나 이상의 DNS 네임 서버를 가지는데 이러한 서버를 권한 네임 서버라고 한다.
-   DNS 네임 서버는 **DNS 정보를 자원 레코드(RR) 형태로 저장**한다. RR은 DNS 트리상의 노드에 대해 특정한 유형의 정보를 포함한다. RR에는 이진 필드 포맷 표현법과 문자 마스터 파일 표현법이 있다. 이진 필드 포맷은 DNS 네임 서버와 변환기(Resolver) 사이의 통신에 사용하며 문자 마스터 파일은 DNS 구역을 운영하기 위하여 관리자가 수정한다.
-   DNS 네임 서버는 구역에 대한 1차 책임을 갖고 있는 마스터 서버, 백업/유지/부하 관리를 위한 2차 슬레이브 서버, 자체적인 DNS RR은 유지하지 않고 다른 구역에서 최근 사용한 정보를 저장하는 캐싱 전용 서버가 있다.
-   DNS의 기능
    -   DNS 네임 공간 : DNS는 모든 네임에 적합한 다계층 구조의 계층적 네임 공간을 사용한다. 네임 공간은 하나의 루트에서 시작해 도메인이라고 부르는 컨테이너로 편성된다.
    -   DNS 네임 등록 : DNS 네임 등록은 DNS의 분산 데이터베이스에 개개의 네임을 입력하는 데 사용한다. DNS는 권한 기관을 계층적으로 배열하는데 이는 계층 네임 공간과 상호보완적이다. 중앙 기관은 네임 공간의 전체적인 모양과 구조를 결정하며 최상위 단계에서의 네임 등록을 처리한다. 그 다음 네임 공간의 각 부분을 관리하는 여러 기관으로 권한을 위임한다. 그리고 일반적인 정책을 통해 네임 등록 과정을 제어하고 충돌과 같은 문제를 해결한다.
    -   네임 서버와 네임 변환 : DNS는 분산 클라이언트/서버 네임 변환 방식을 사용한다. **네임 변환 과정은 서버 역할의 네임 서버와 클라이언트 역할의 변환기(resolver)로 구현**한다. DNS 네임 서버는 하드웨어 서버에서 동작하는 특수 프로그램으로, 이 서버는 DNS 네임 공간 각 부분에 대한 관리 제어 권한을 가지는 조직에서 관리한다. 그리고 이 조직은 네임, 주소, 네임 공간의 특징에 대한 설명을 담고 있는 자원 레코드도 유지한다. **네임 서버의 주된 작업은 네임 변환 요청을 받은 후 데이터베이스에서 자료를 가져와 응답하거나 해당 정보를 알려줄 다른 네임 서버의 네임을 알려주는 것이다. 네임 변환기(Resolver)는 네임 변환 과정에서 클라이언트로 동작한다. 사용자가 네트워크 애플리케이션에 네임을 입력하면 네임은 변환기에게 전달된다.** 변환기는 해당 네임에 대한 변환 요청을 네임 서버로 보낸다. 변환기는 캐싱을 사용하거나 다른 기능을 구현할 수도 있다.
-   DNS 네임 변환에는 반복전 변환과 재귀적 변환이라는 두 가지 방법이 있다. **반복적 변환에서는 클라이언트가 적절한 정보를 가지고 있지 않은 네임 서버에게 요청을 보내면 서버는 다른 네임 서버 주소를 알려준다. 재귀적 변환에서는 클라이언트가 요청한 정보가 없는 서버에게 요청을 보내면 서버가 필요한 레코드를 찾아내기 위해 다른 서버에게 요청을 보낸다.** 이 서버는 다른 서버로 요청을 보내는데 있어 클라이언트의 역할을 맡는다.
-   **DNS 네임 서버가 수행하는 캐싱과 더불어 많은 DNS 변환기 또한 최근의 변환 요청 결과를 캐싱**한다. 동일한 네임에 대한 다수의 요청이 발생할 때 네임 변환 전에 미리 캐시를 검사한다. 그 외에도 네임 변환 요청 전에 호스트 테이블 방식을 통해 로컬 변환을 시도한다.
-   **DNS 네임 변환 예시**
    
    -   해당 내용은 TCP/IP 완벽 가이드 내용을 참고한다.
    -   다음 내용은 XYZ 회사의 직원이 자신의 웹 브라우저에 대학 네트워크 부서 웹 서버 주소인 `www.net.compsci.googleplex.edu`를 입력했을 때 이 네임에 대한 변환 절차를 설명한다.
        -   XYZ 회사가 xyzindustries.com 구역을 위한 네임 서버(ns1.xyzindustries.com/ns2.xyzindustries.com)을 운영한다고 가정한다. DNS 서버가 회사 내 머신으로부터의 재귀적 요청을 받아들이며, 서버와 변환기 모두 캐싱을 수행한다. 예제에서는 현재 캐시가 비어있다고 가정한다.
        -   Googleplex 대학은 googleplex.edu 도메인을 위한 자체 DNS 서버(compsci.googleplex.edu/admin.googleplex.edu)를 운영한다고 가정한다. 여기서 compsci.googleplex.edu는 전용 서버를 가지고 개별적인 구역에 있지만 다른 하위 도메인은 googleplex.edu 구역 내에 있다고 가정한다.
    -   [![DNS_Resolutino](https://github.com/pr0gr4m/CS_Interview/raw/main/img/DNS_Resolution.png?raw=true)](https://github.com/pr0gr4m/CS_Interview/blob/main/img/DNS_Resolution.png?raw=true)
    
    1.  네임에 대한 요청을 웹 브라우저가 인식하고 `www.net.compsci.googleplex.edu`라는 네임을 변환기에게 넘겨주며 로컬 변환기를 호출한다.
    2.  변환기는 자신의 캐시에 네임 주소가 저장되어 있는지 확인한다. 캐시되어 있다면 웹 브라우저에게 바로 주소를 반환하지만 그렇지 않다고 가정한다. 변환기는 로컬 호스트 테이블 파일에 해당 항목이 있는지도 검사하는데, 예제에는 테이블에 엔트리 또한 없다고 가정한다.
    3.  변환기가 재귀적 질의를 생성한 후 이를 변환기가 이미 알고 있는 네임 서버의 IP 주소를 통해 ns1.xyzindustries.com에 보낸다.
    4.  로컬 DNS 서버는 요청을 받고 자신의 캐시를 확인한다. 만약 캐시에 정보가 있다면 non-authoritative라고 표시된 정보를 변환기에 보낸다. 서버는 자신의 구역 자원 레코드에 `www.net.compsci.googleplex.edu`를 변환할 수 있는 정보가 있는지도 검사한다. 예제에서는 캐시 정보도 없고, 도메인도 다르기 때문에 필요한 정보가 없다고 가정한다.
    5.  ns1.xyzindustries.com이 네임에 대한 반복적 요청을 생성하고 이를 루트 네임 서버에게 보낸다.
    6.  루트 네임 서버는 이 네임을 변환하지 않고 .edu 도메인을 담당하는 서버의 네임과 주소를 반환한다.
    7.  ns1.xyzindustries.com은 반복적 요청을 생성하고 이를 .edu 도메인을 담당하는 서버에게 전송한다.
    8.  .edu 도메인을 담당하는 서버는 googleplex.edu를 담당하는 서버의 네임과 주소를 반환한다.
    9.  ns1.xyzindustries.com은 반복적 요청을 생성하고 이를 googleplex.edu를 담당하는 서버에게 보낸다.
    10.  googleplex.edu 도메인을 담당하는 서버는 자신의 레코드를 찾아본다. 그러나 해당 네임이 개별적인 구역에 있는 compsci.googleplex.edu 하위 도메인에 존재하는 것을 알아내고 그 구역을 담당하는 네임 서버의 주소를 반환한다.
    11.  ns1.xyzindustries.com은 반복적 요청을 생성하고 이를 compsci.googleplex.edu를 담당하는 네임 서버로 보낸다.
    12.  compsci.googleplex.edu를 담당하는 서버는 `www.net.compsci.googleplex.edu`의 권한 서버이다. 이 서버는 해당 호스트의 IP 주소를 ns1.xyzindustries.com에 반환한다.
    13.  ns1.xyzindustries.com은 변환 정보를 캐시에 저장한다.
    14.  로컬 네임 서버는 변환 정보를 로컬 머신상의 변환기에게 반환한다.
    15.  로컬 변환기가 변환 정보를 캐시에 저장한다.
    16.  로컬 변환기가 브라우저에게 주소를 넘긴다.
    17.  브라우저가 Googleplex 머신의 IP 주소로 HTTP 요청을 시작한다.
-   **이메일**은 IP 주소가 아니라 호스트 네임을 이용해서 전송하기 때문에 DNS는 사이트 간의 메일 전송을 지원하기 위해 특별한 기능을 포함한다. 특수 메일 교환(MX) DNS RR은 도메인 수신 이메일을 처리하는데 사용하는 메일 서버의 네임을 포함하도록 설정되어 있다. 사이트로 메일을 전송하기 전에 장비는 메시지를 어디로 보낼지 알기 위해 **해당 사이트의 MX 레코드를 얻기 위한 네임 변환을 수행**한다.

