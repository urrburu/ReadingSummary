# 생성자 대신 정적 팩토리 매서드를 고려하라

TDD에서도 이와 비슷한 말이 있긴 했다. 정적 팩터리 메서드를 사용하여 객체를 생성하는 이름이 있는 메서드를 사용하면, 개발자는 더 직관적으로 객체를 생성할 수 있다.

## **장점**

1.  이름을 가질 수 있다.
2.  호출될 때마다 인스턴스를 새로 생성하지않아도된다.
3.  반환 타입의 하위 타입 객체를 반환할 수 있는 능력이 있다.
4.  입력 매개변수에 따라 매번 다른 클래스의 객체를 반환할 수 있다.
5.  정적팩토리 메서드를 작성하는 시점에는 반환할 객체의 클래스가 존재하지 않아도 된다.

## **단점**

1.  상속을 하라면 public이나 protected 생성자가 필요하니 정적 팩터리 메서드만 제공하면 하위 클래스를 만들 수 없다. -> 다시 말하자면 상속을 해줄 클래스에는 이 패턴을 사용하면 안된다.  상속을 받고 받은 맨 끝에 있는 애를 이걸로 간단하게 생성하는게 제일 효율적이다. 

2.  정적 팩터리 메서드는 프로그래머가 찾기 어렵다.

# 생성자에 많은 매개변수가 많다면, 빌더를 고려하라

점층적 생성자 패턴 -> 필수 매개변수만 받는 생성자, 선택 패러미터의 개수를 달리해서 생성할 수 있는 생성자....

하지만 이런건 매개변수의 수가 많으면 읽기가 힘들다. 

자바빈즈 -> 생성 + 추가로 세터를 이용해서 패러미터들을 세팅하는 방식\
객체하나를 만드는거 뿐인데 여러개의 세터를 호출해야하고 세터를 많이 만드는건 그다지 좋은 습관이 아니며 객체가 완전히 생성되기 까지는 클래스을 불변으로 만들 수 없으며 스레드 안정성을 얻으려면 추가작업이 반드시 필요하다. 낭비다.....
이를 보완하기 위한 프리징 도 있다. 실전에서는 쓰지 않는다. 프로그래머가 프리즈 매소드를 호출했는지 컴파일러가 보증할 방법이 없어 많이 귀찮아지는 방식이다

## 그래서 빌더패턴
롬복의 빌더 어노테이션을 붙이면서 간단하게 구현 가능. 필요한 객체를 직접 만드는 대신, 필수 매개변수 만으로 생성자를 호출해 빌더 객체를 얻는다. 그런 다음 빌더 객체가 제공하는 일종의 세터 매서드들로 원하는 선택 매개변수들을 설정한다. 마지박으로 매개변수가 없는 빌드 매서드를 호출해 보통은 불변의 객체를 얻는다. 빌더는 생성할 클래스 안에 정적멤버 클래스로 만드는 것이 보통이다. 

### 명명된 선택적 매개변수 패턴 - named optional parameters 
파이썬이나 스칼라를 써본 유저라면 이것과 유사하다고 설명해주면 된다. 

잘못된 매개션수를 검사하려면 빌더의 생성자와 매서드에서 입력 매개변수를 검사하고 빌드 매서드와 홏출하는 생성자에서 여러 매개변수에 걸친 불변식을 검사하는 방법이 있다. 공격에 대비해 이런 불변식을 보장하려면 빌더로부터 매개변수를 복사한 후 해당 객체 필드들도 검사해야한다. 검사해서 잘못된 점을 발견하면 어떤 패러미터에서 오류가 발생했는지를 보여주는 메시지와 함께 IllealArgumentException을 던지면 된다.

빌더 패턴은 계층적으로 설계된 클래스와 함께 쓰기에 좋다. 각 계층의 큺래스에 관련 빌더를 멤버로 정의하자. 추상 클래스는 추상 빌더를 , 구체 클래스는 구체 빌더를 갖게 한다. 

빌더패턴은 유연한 장점을 갖는다. 빌더 하나로 여러 객체를 순회하면서 만들 수 있고, 빌더에 남기는 매개변수에 따라 다른 객체를 만들 수도 있다. 

# private 생성자나 Enum 타입으로 싱글턴임을 보증하라

싱글턴 패턴 - 단 한번만 인스턴스를 생성해서 해당 메모리 영역을 참조하는 방식

대개 무상태 객체나 설계상 유일해야하는 시스템 컴포넌트가 그 예로 들어간다. 

클래스를 싱글턴으로 만들면 이를 사용하는 클라이언트를 테스트하기가 힘들어질 수 있다. 싱글턴 인스턴스를 mock구현으로 대체할 수 없기 때문이다. 

생성자는 private로 감춰두고 유일한 인스턴스에 접근할 수 있는 수단인 public static 멤버를 하나 마련한다. 