# 데이터베이스를 여러개로 만드는 방법

클러스터링 -> 데이터베이스가 죽으면 어쩌지?  -> DB를 여러개로 만들자!
(액티브 -  액티브)
장점 : 시스템 전체가 정지하는 것을 막을 수 있다. 성능향상
단점 : 병목되는 상황에 대한 고려가 필요하다. 비용이 비싸다.
(액티브 - 스탠드바이)
장점 : 비용이 저렴하다
단점 : 액티브가 죽었을때 전환시 시간이 오래 걸린다.

Replication

저장된 데이터가 손실되면 어쩌지? -> 실제 저장소도 복제하자!

단순분할 & 부하분산에 사용

샤딩 
데이터가 너무 많아서 검색이 느린데 더 빠르게 할 수 있는 방법은 없을까?

테이블을 쪼개서 여러개로 사용한다면? -> 검색자체를 더 빠르게 진행가능

1. 분산된 데이터베이스에 데이터를 어떻게 잘 분산시켜서 저장할 것인가?
2. 분산된 데이터베이스에서 데이터를 어떻게 읽을 것인가?

shard Key
나눠진 샤드 중 어떤 샤드를 선택할지 결정하는 키

Shard Key 결정 방식에 따라 Sharding 방법이 나뉜다.

해쉬샤딩 (Id%4) 를 이용해서 여러 데이터베이스에 나눈다 -> 구현이 간단하지만 확장성이 떨어진다. 공간에대한 효율을 고려하지 않는다. 

다이나믹 샤딩
로케이터 서비스를 두고 여기에 샤드키만 추가하는 방식으로 샤딩 진행 -> 로케이터 서비스에 종속적
데이터 재배치시 로케이터 서비스도 동기화해야한다. 로케이터에 의존적이라 로케이터에 문제가 생기면 DB에도 문제가 생긴다. 

엔티티그룹 샤딩방식
관계가 있는 엔티티끼리 같은 샤드내에서 공유하도록 만드는 방식 
단일 샤드 내에서 쿼리가 효율적이다. 단일 샤드 내에서 강한 응집도를 가진다. 
하지만 다른 샤드의 엔티티를 참조해야할 경우 비효율적이다.

