## 3) 부분범위 처리로의 유도

 부분범위 처리를 효과적으로 사용하면 우리가 염려해 온 넓은 범위의 처리도 빠른 수행속도를 얻을 수는 있으나 그렇다고 해서 모든 경우를 부분범위로 처리할 수는 없다고 했다. 그러나 RDBMS가 가지고 있는 기능을 최대한 활용한다면 우리는 보다 많은 처리를 부분범위 처리 방법으로 유도할 수 있다. 우리는 다음과 같은 다양한 방법들을 사용해 부분범위 처리로 유도할 수 있다. 

 - 액세스 경로를 이용한 SORT의 대체
 - 인덱스만 처리하는 부분범위 처리
 - MIN, MAX의 처리
 - FILTER형 부분범위 처리
 - ROWNUM을 이용한 부분범위 처리
 - 인라인뷰를 이용한 부분범위처리
 - 저장형 함수를 이용한 부분범위 처리
 - 쿼리의 이원화를 이용한 부분범위처리
 - 웹 게시판에서의 부분범위 처리

### 3.1) 액세스 경로를 이용한 SORT의 대체
우리는 일반 인덱스나 클러스터 인덱스가 컬럼값으로 정렬되어 있다는 것을 잘 알고 있다. 앞서 살펴봤듯이 대개의 ORDER BY 는 전체범위 처기가 된다. 만약 우리가 정렬하고자 하는 순서와 액세스를 주관하는 인덱스의 컬럼이 앞부분이 같다면 인덱스를 사용하여 부분범위 처리를 유도해 ORDER BY를 하지 않아도 동일한 결과를 추출할 수 있다. 그리고 힌트를 사용하면 역순으로 정렬하는 경우도 적용이 가능하다. 

부분번위 처리로 유도하기 위해서는 인덱스를 구성하고 있는 컬럼의 순서가 아주 중요한 결정 요소가 된다. 만약 'SAFETY_STOCK'라는 컬럼이 조건절에는 전혀 사용되지 않지만 'ITEM_CD, SAFETY_STOCK'으로 정렬되는 액세스가 아주 빈번하게 발생하고 있으나 항상 처리할 범위가 넓어서 전체범위 처리로는 큰 부담이 된다면, ITEM_CD+ SAFETY_STOCK 으로 된 결합 인덱스르 ㄹ생생해 해셜할 수 있다. 이와같이 액세스의 조건으로 사용되지 않더라도 ORDER BY를 없애기 위한 목적만으로 인덱스에 필요한 컬럼을 추가하는 것도 좋은 활용방법이 될 수 있다.  

where 조건절을 이용해서 범위를 제한하여 부분범위 처리를 유도하는 테크닉이 인상 깊었다. 책을 다시 찾아볼 수 있도록 하고 


"액세스 주관 컬럼의 처리 범위가 넓어도 다른 조건의 처리 범위도 같이 넓으면 빠르다"는 원리를 기억하도록 하자.

### 3.2) 인덱스만 액세스 하는 부분범위 처리

옵티이저는 사용자의 의도와는 상관 없이 인덱스 만으로 처리할 수 있다고 판단되면 테이블을 액세스하지 않고 인덱스만 액세스 하는 실행계획을 수립한다. 우리가 지금까지 넓은 범위의 처리를 위해 많은 노력을 기울인 주된 이유는 처리할 인덱스의 범위가 넓기 때문만은 아니다. 엄밀히 말하자면 처리범위가 넓어지면 인덱스를 통해 테이블을 액세스하는 랜덤 처리량이 크게 증가하기 때문이다.
인덱스는 첫번째 로우을 찾을때만 랜덤 액세스를 하고 그 다음부터는 스캔을 하지만 테이블을 액세스하는 행위는 항상 랜덤 액세스를 해야 한다. 그러므로 수행속도에 가장 많은 영향을 주는 테이블 랜덤 액세스를 하지 않고 인덱스로만 처리할 수 있다면 비록 처리범위가 넓더라도 효율적인 처리를 할 수 있다. 이러한 방식으로 유도하기 위한 최대의 관건은 역시 인덱스가 어떻게 구성되어 있느냐에 달려있다. 

 조건에 있는 각 컬럼들에 별도의 인덱스가 존재하더라도 항상 모든 인덱스가 사용되는 것은 아니다. 옵티마이져는 주어진 SQL 에서 사용되 ㄴ컬럼들이 여러개의 인덱스에 분산되어 있다면 그리 쉽게 인덱스만 사용하는 실행계획을 수립하지 않는다. 인덱스만 사용하는 실행계획이 수립되기 위해서는 다음과 같은 경우에 해당되어야 한다. 
- 쿼리에 사용된 모든 컬러들이 하나의 인덱스에 결합되어 있거나
- 인덱스 머지가 되는 실행계획이 수립되려면 머지되는 두개의 인덱스 내에 모든 컬럼들이 모두 사용되어야 한다. 우리는 앞서 인덱스 머지에 대해서 상세하게 살펴본 적이 있다. 
-  쿼리에 사용된 전체 컬럼들이 몇개의 인덱스에 모두 포함될 수 있다면 인덱스 조인이 성입하게 된다. 이런 경우는 인덱스들만 이용해서 조인을 하는 실행계획이 수립된다. 


결합 인덱스의 구성에서 어떤 컬럼들과 결합하느냐에 따라 액세스에 미치는 영향은 아주 다양하게 드러나므로 인덱스를 구성할 때는 반드시 액세스 형태를 조사하여 전략적인 결정을 하여야 한다.